class Solution:
    def minBuildTime(self, blocks: List[int], split: int) -> int:
        N = len(blocks)
        blocks.sort(reverse=True) # 從大到小排序

        table = [[-1]*(N+1) for _ in range(N)]
        @cache 
        def ask(i, k): # 完成0...i blocks, 使用k workers
            # print("N:", N, "i:",i,"k:",k)
            # 終止條件
            if i==N: # 順利走到最後
                return 0
            if k == 0: # 工人不夠用
                return inf
            if k >= N-i: # 有夠多的 worker
                return blocks[i] # 直接知道耗時多久
            if table[i][k] != -1:
                return table[i][k]

            work_here = max(blocks[i], ask(i+1, k-1)) # 現在挑個 worker做blocks[i], 剩下繼續問
            split_here = split + ask(i, min(k*2, N-i)) # 現在有花 split時間分兩群,工人k*2,上限N-i
            table[i][k] = min(work_here, split_here)
            return table[i][k]
            
        return ask(0, 1) # top-down解法，先0個blocks,1 worker

# case 27/37 資料有 1000筆
# [86335,7059,80193,72911,51302,10201,15791,7055,23528,28624,95312,86791,51469,74680,4988,98558,98349,77992,61117,43241,46000,80323,22939,85780,77317,3494,44779,80474,97736,66894,25179,50779,21352,8358,83651,39740,23786,62944,38151,74531,28048,37629,81980,77737,45581,73804,15711,76605,6871,5685,46347,60039,64788,84571,39604,36582,37200,63122,96472,72420,31026,31115,66202,46624,63671,11486,77059,62495,43566,43268,9870,31843,2273,28908,1084,26353,14665,41701,88397,35442,68863,84508,60363,78862,2952,45215,50392,92765,45942,77819,74188,29325,24903,71535,91597,59008,15339,29882,98720,70355,97119,15157,2830,91629,74291,21205,24962,76078,82412,96898,28189,85773,31566,18539,35050,89140,13341,22841,75405,97322,7414,86246,30146,86083,5204,46817,30267,12647,53654,98951,91360,97567,61696,30220,75185,71862,79852,12247,5558,23931,12281,31807,63262,15361,58077,58508,86541,21553,53530,17766,49591,33913,72626,58032,76059,75530,1552,35462,13442,57437,41817,13264,79178,45419,45017,66179,3308,4995,2497,25879,90241,56819,62222,72381,9928,66878,66091,25639,56460,68821,15548,70134,86502,28278,7588,54848,66587,53699,53894,65124,3096,25506,52818,10523,16419,16771,51560,28757,12417,35630,99113,30824,49586,53814,90794,79115,86828,99609,98309,37323,41522,12541,39229,38601,50878,4240,81730,63512,38823,79494,3012,26075,56948,15008,79243,58258,28457,82692,83332,78393,54552,25118,17281,68054,57098,42026,79137,99207,55515,29492,20888,51597,46617,53356,1088,37387,50803,70435,51983,77135,76557,52038,10578,74271,46422,16351,27049,87890,74470,29123,13677,58054,40226,44357,60509,59210,58093,54136,17575,22146,38875,32093,53570,61681,87405,86064,74578,656,58092,63833,64136,98603,42411,64665,69004,19082,27625,30329,75308,81115,37143,223,86733,83914,43676,84138,65606,61022,65446,55442,23615,7243,12209,84989,56504,23567,91272,72220,6915,31238,33374,61895,11803,96660,81445,85027,57978,84466,60431,80058,7103,89385,9014,24597,38309,73042,186,73394,51237,75499,52563,7604,49510,82646,76065,59327,61480,68160,61831,36927,98279,99567,62132,51752,85799,49961,88534,58213,47753,91975,54814,18972,98571,22188,10490,40635,59719,90720,91819,61378,96547,29350,23683,79705,873,56697,16478,54931,32705,64288,30009,11984,23736,39345,17144,97416,28921,9178,62705,61708,60999,38109,96213,28430,2589,31458,21751,83883,44357,1609,41709,1854,90150,3872,47361,6547,72406,58513,38254,61230,18685,13267,82014,84821,20289,14348,69157,29694,46819,47858,68539,76317,936,15790,37840,99969,19367,54908,82237,58494,88905,35432,48293,88781,87584,79242,93563,60364,181,30034,29507,48171,52377,73873,84912,15636,96546,87260,38181,20726,55369,16807,18358,33808,49932,42829,78400,34818,42433,39356,42429,61108,46018,38594,29066,49728,12811,84828,23751,39786,77989,73133,8940,4284,63549,77569,44116,28583,58866,47339,9701,36066,88860,4793,46308,40660,28051,42177,59556,72669,50294,40135,76015,8026,27249,71017,35893,20902,17682,66607,73525,78542,5654,185,59947,8057,19857,17193,55457,34130,50418,89234,41569,37752,34597,3450,30811,63023,47068,64305,8885,2085,394,4858,67959,7473,81285,14896,579,81028,13825,75206,97653,53116,78255,99089,22980,29365,19053,69794,301,1100,15852,74223,13227,27121,59943,4519,68652,1466,47724,11538,94397,1300,7218,69221,36294,40361,14544,67562,14008,86624,42565,24799,24281,93052,34196,31159,21136,38149,65652,30702,9781,14269,90243,42865,16142,52494,59312,91305,48536,44241,56874,15430,24707,97721,65732,4499,63803,72725,53628,17282,85332,34873,76720,55908,16258,35318,12058,23111,98110,55717,83840,2537,66160,68551,14940,67457,47061,69755,45150,17044,40566,58207,22860,43111,78244,42718,8340,9317,90508,22705,42265,99457,50019,71576,66322,96083,51451,72829,43347,18767,99846,83468,18195,7113,44546,88503,94137,8661,38881,25547,80883,32700,57223,70771,23942,38890,1165,87537,40383,82397,47042,38714,75871,31928,11976,92022,20202,83313,57838,79912,30595,31428,81124,83429,29529,15358,68732,50297,27908,1110,16071,5005,81398,85112,51351,60377,5284,61878,95307,49764,52175,7626,2905,66487,21757,47480,95731,86366,13218,98205,41478,54668,54018,9222,10543,78428,31800,58010,43794,30447,92218,48733,65908,28445,35263,39951,26525,32234,52076,30070,47424,47835,6034,59239,39899,80050,12301,78500,24571,73712,60039,924,98196,67520,8950,16652,23110,13336,97460,96039,801,65563,93090,32322,38001,7271,50931,55713,19159,73752,60967,14527,4314,69695,18858,46895,84792,79055,31080,72869,97677,24066,27185,71302,67667,38265,36151,21695,52903,60275,68058,74985,94445,32692,99844,29466,61226,36331,16158,111,32222,42834,11994,23793,322,60538,18140,35689,13590,38009,58954,34672,23396,384,38446,30125,47826,38213,19355,64420,31922,92779,74795,50054,51068,35686,13782,79649,6418,67487,77344,65936,94420,26391,37108,32267,71304,99690,52598,48078,96047,35662,98796,38058,48184,24640,99194,88079,74993,84088,19739,37343,58282,84261,68749,1889,98922,78932,13271,63504,79107,19989,66867,48030,41456,29629,67469,85075,33849,10682,23573,13966,55561,11191,92564,45521,28389,62996,58482,71232,9508,903,77662,99426,42070,820,10916,77910,93154,93615,21771,98581,46391,21321,55817,69164,37372,82555,8685,96768,24704,72523,23463,81403,86714,34101,37325,3718,20637,63092,5350,76644,38128,2024,61073,13464,42399,18519,17257,22125,31487,30264,83446,71212,37700,42061,30344,86337,34398,19874,71375,57866,43599,62958,23507,593,90031,15011,19321,17189,89165,8102,60564,92638,85245,85302,65250,73064,91669,90862,23409,62433,16901,22811,49133,41731,48878,41001,93049,57882,34728,11148,64140,74349,63991,27641,32910,41595,65538,63363,34730,64833,10638,41003,95379,89838,61832,88503,52809,32874,65381,3320,80166,90817,21582,23141,32633,68904,63543,25670,49530,42982,18693,81807,96013,59253,72377,1155,20300,27185,49940,86250,74718,84723,70588,48654,22537,27878,45015,53747,80353,13579,3379,4833,75636,98304,19475,30381,16816,58772,72294,60634,74623,64504,35173,30548,37176,80117,84000,50786,92000,1197,72383,95119,24852,56064,72887,53882]
